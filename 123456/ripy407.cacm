MADCAP: A Scientific Compiler for a Displayed Formula Textbook Language