Optimal Code for Serial and Parallel Computation